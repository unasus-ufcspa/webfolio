
tinymce.PluginManager.add('pluginImage', function (editor, url) {
// Add a button that opens a window
    editor.addButton('pluginImage', {
        title: 'Imagem',
        image       : url + '/ic_picgallery.png',
        onclick: function () {
            // Open window
            var teste = editor.windowManager.open({
                title: 'Inserir Imagem:',
                url: '/webfolio/baixarImagem',
                width: 500,
                height: 200,
                buttons: [{
                        text: 'Colocar no texto',
                        subtype: 'primary',
                        onclick: function (e) {
                            // TODO: handle primary button click
                            var frame = $(e.currentTarget).find("iframe").get(0);
                            var content = frame.contentDocument;

                            var result = $(content).find("img");
                           // alert(result[0].outerHTML);
                            if (result[0] != null) {
                             //   alert(result[0].outerHTML);
                                tinymce.activeEditor.insertContent(result[0].outerHTML);
                                 editor.windowManager.close(this);
                            }else{
                                alert("Carregue o video");
                            }
                          
                            //console.log(e);
                        }}]

            });
        }
    });
});
// // Insert content when the window form is submitted
//                    console.log(e);
//                    console.log(d);
//                    console.log(b);
//                   var ttt =  editor.windowManager.getElementsByTagName('img');
//                console.log(ttt);
//
//                        html: "<form id='sendFiles' action='/webfolio/app_dev.php/uploadWeb' method='post' enctype='multipart/form-data'>" +
//                                "<input type='file' name='arquivo'>" +
//                                "<button type='submit'>file</button>" +
//                                "</form>"  
//                                e.data.file = e.data.file.replace(/C:\\fakepath\\/i, '');
//                    console.log(e.data.file);                    
//                    var nomeVideo = e.data.file.substr(0, e.data.file.lastIndexOf('.'));
//                    tinymce.activeEditor.insertContent("<img src='/webfolio/uploads/"+nomeVideo+".jpg' class='mce-object mce-object-video'>");
//                  